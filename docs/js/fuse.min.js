(function(a,b){typeof exports=='object'&&typeof module!='undefined'?module.exports=b():typeof define=='function'&&define.amd?define(b):(a=a||self,a.Fuse=b())})(this,function(){'use strict';var aa,an,Y,Q,J,K,L,C,N,S,T,ao,V,a,X,s,j,G,f,ai,aj,ak,al,am,Z,F,B,o,y,$,H,R,M,n,m,t,r,ab,ac,z,l;function p(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?p=function(a){return typeof a}:p=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},p(a)}function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function ag(d,c){for(var b=0,a;b<c.length;b++)a=c[b],a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}function c(a,b,c){return b&&ag(a.prototype,b),c&&ag(a,c),a}function D(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function af(a,d){var b=Object.keys(a),c;return Object.getOwnPropertySymbols&&(c=Object.getOwnPropertySymbols(a),d&&(c=c.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),b.push.apply(b,c)),b}function ae(c){for(var a=1,b;a<arguments.length;a++)b=arguments[a]!=null?arguments[a]:{},a%2?af(Object(b),!0).forEach(function(a){D(c,a,b[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(b)):af(Object(b)).forEach(function(a){Object.defineProperty(c,a,Object.getOwnPropertyDescriptor(b,a))});return c}function i(b,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),a&&A(b,a)}function q(a){return q=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},q(a)}function A(a,b){return A=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},A(a,b)}function aH(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function aM(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function aG(b,a){return a&&(typeof a=="object"||typeof a=="function")?a:aM(b)}function k(a){var b=aH();return function(){var d=q(a),c,e;return b?(e=q(this).constructor,c=Reflect.construct(d,arguments,e)):c=d.apply(this,arguments),aG(this,c)}}function h(a){return aF(a)||aE(a)||aD(a)||aC()}function aF(a){if(Array.isArray(a))return w(a)}function aE(a){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(a))return Array.from(a)}function aD(a,c){if(!a)return;if(typeof a=="string")return w(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if(b==="Object"&&a.constructor&&(b=a.constructor.name),b==="Map"||b==="Set")return Array.from(a);if(b==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return w(a,c)}function w(c,a){(a==null||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function aC(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(a){return Array.isArray?Array.isArray(a):I(a)==='[object Array]'}aa=1/0;function aB(a){if(typeof a=='string')return a;var b=a+'';return b=='0'&&1/a==-aa?'-0':b}function aA(a){return a==null?'':aB(a)}function e(a){return typeof a=='string'}function W(a){return typeof a=='number'}function ay(a){return a===!0||a===!1||ax(a)&&I(a)=='[object Boolean]'}function U(a){return p(a)==='object'}function ax(a){return U(a)&&a!==null}function d(a){return a!==void 0&&a!==null}function E(a){return!a.trim().length}function I(a){return a==null?a===void 0?'[object Undefined]':'[object Null]':Object.prototype.toString.call(a)}an='Extended search is not available',Y="Incorrect 'index' type",Q=function(a){return"Invalid value for key ".concat(a)},J=function(a){return"Pattern length exceeds max of ".concat(a,".")},K=function(a){return"Missing ".concat(a," property in key")},L=function(a){return"Property 'weight' in key '".concat(a,"' must be a positive integer")},C=Object.prototype.hasOwnProperty,N=function(){function a(e){var d=this,c;b(this,a),this._keys=[],this._keyMap={},c=0,e.forEach(function(b){var a=O(b);c+=a.weight,d._keys.push(a),d._keyMap[a.id]=a,c+=a.weight}),this._keys.forEach(function(a){a.weight/=c})}return c(a,[{key:"get",value:function(a){return this._keyMap[a]}},{key:"keys",value:function(){return this._keys}},{key:"toJSON",value:function(){return JSON.stringify(this._keys)}}]),a}();function O(a){var c=null,d=null,f=null,h=1,b;if(e(a)||g(a))f=a,c=P(a),d=v(a);else{if(!C.call(a,'name'))throw new Error(K('name'));if(b=a.name,f=b,C.call(a,'weight'))if(h=a.weight,h<=0)throw new Error(L(b));c=P(b),d=v(b)}return{path:c,id:d,weight:h,src:f}}function P(a){return g(a)?a:a.split('.')}function v(a){return g(a)?a.join('.'):a}function aw(f,b){var a=[],c=!1,h=function l(j,f,h){var k,b,i,m;if(!d(j))return;if(f[h]){if(k=f[h],b=j[k],!d(b))return;if(h===f.length-1&&(e(b)||W(b)||ay(b)))a.push(aA(b));else if(g(b)){c=!0;for(i=0,m=b.length;i<m;i+=1)l(b[i],f,h+1)}else f.length&&l(b,f,h+1)}else a.push(j)};return h(f,e(b)?b.split('.'):b,0),c?a:a[0]}S={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},T={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:function(a,b){return a.score===b.score?a.idx<b.idx?-1:1:a.score<b.score?-1:1}},ao={location:0,threshold:.6,distance:100},V={useExtendedSearch:!1,getFn:aw,ignoreLocation:!1,ignoreFieldNorm:!1},a=ae({},T,{},S,{},ao,{},V),X=/[^ ]+/g;function au(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3,a=new Map,b=Math.pow(10,c);return{get:function(e){var c=e.match(X).length,f,d;return a.has(c)?a.get(c):(f=1/Math.sqrt(c),d=parseFloat(Math.round(f*b)/b),a.set(c,d),d)},clear:function(){a.clear()}}}s=function(){function f(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=d.getFn,e=c===void 0?a.getFn:c;b(this,f),this.norm=au(3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}return c(f,[{key:"setSources",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.docs=a}},{key:"setIndexRecords",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.records=a}},{key:"setKeys",value:function(){var b=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.keys=a,this._keysMap={},a.forEach(function(a,c){b._keysMap[a.id]=c})}},{key:"create",value:function(){var a=this;if(this.isCreated||!this.docs.length)return;this.isCreated=!0,e(this.docs[0])?this.docs.forEach(function(b,c){a._addString(b,c)}):this.docs.forEach(function(b,c){a._addObject(b,c)}),this.norm.clear()}},{key:"add",value:function(a){var b=this.size();e(a)?this._addString(a,b):this._addObject(a,b)}},{key:"removeAt",value:function(b){this.records.splice(b,1);for(var a=b,c=this.size();a<c;a+=1)this.records[a].i-=1}},{key:"getValueForItemAtKeyId",value:function(a,b){return a[this._keysMap[b]]}},{key:"size",value:function(){return this.records.length}},{key:"_addString",value:function(a,b){if(!d(a)||E(a))return;var c={v:a,i:b,n:this.norm.get(a)};this.records.push(c)}},{key:"_addObject",value:function(c,f){var a=this,b={i:f,$:{}};this.keys.forEach(function(i,h){var f=a.getFn(c,i.path),j;if(!d(f))return;g(f)?function(){for(var j=[],i=[{nestedArrIndex:-1,value:f}],k,l,c,m;i.length;){if(k=i.pop(),l=k.nestedArrIndex,c=k.value,!d(c))continue;e(c)&&!E(c)?(m={v:c,i:l,n:a.norm.get(c)},j.push(m)):g(c)&&c.forEach(function(a,b){i.push({nestedArrIndex:b,value:a})})}b.$[h]=j}():E(f)||(j={v:f,n:a.norm.get(f)},b.$[h]=j)}),this.records.push(b)}},{key:"toJSON",value:function(){return{keys:this.keys,records:this.records}}}]),f}();function _(d,e){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},c=f.getFn,g=c===void 0?a.getFn:c,b=new s({getFn:g});return b.setKeys(d.map(O)),b.setSources(e),b.create(),b}function at(d){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=e.getFn,f=c===void 0?a.getFn:c,g=d.keys,h=d.records,b=new s({getFn:f});return b.setKeys(g),b.setIndexRecords(h),b}function u(o){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=b.errors,n=e===void 0?0:e,f=b.currentLocation,l=f===void 0?0:f,h=b.expectedLocation,k=h===void 0?0:h,j=b.distance,d=j===void 0?a.distance:j,g=b.ignoreLocation,m=g===void 0?a.ignoreLocation:g,c=n/o.length,i;return m?c:(i=Math.abs(k-l),!d)?i?1:c:c+i/d}function ar(){for(var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a.minMatchCharLength,e=[],b=-1,f=-1,c=0,i=d.length,h;c<i;c+=1)h=d[c],h&&b===-1?b=c:!h&&b!==-1&&(f=c-1,f-b+1>=g&&e.push([b,f]),b=-1);return d[c-1]&&c-b>=g&&e.push([b,c-1]),e}j=32;function aq(z,e,S){var g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},G=g.location,R=G===void 0?a.location:G,L=g.distance,r=L===void 0?a.distance:L,K=g.threshold,W=K===void 0?a.threshold:K,O=g.findAllMatches,T=O===void 0?a.findAllMatches:O,D=g.minMatchCharLength,E=D===void 0?a.minMatchCharLength:D,H=g.includeMatches,I=H===void 0?a.includeMatches:H,N=g.ignoreLocation,w=N===void 0?a.ignoreLocation:N,l,m,b,k,f,p,B,o,V,A,n,q,v,Q,h,s,d,P,C,y,i,c,t,F,U,x,M;if(e.length>j)throw new Error(J(j));for(l=e.length,m=z.length,b=Math.max(0,Math.min(R,m)),k=W,f=b,p=E>1||I,B=p?Array(m):[];(o=z.indexOf(e,f))>-1;)if(V=u(e,{currentLocation:o,expectedLocation:b,distance:r,ignoreLocation:w}),k=Math.min(V,k),f=o+l,p)for(A=0;A<l;)B[o+A]=1,A+=1;f=-1,n=[],q=1,v=l+m,Q=1<<l-1;for(h=0;h<l;h+=1){for(s=0,d=v;s<d;)P=u(e,{errors:h,currentLocation:b+d,expectedLocation:b,distance:r,ignoreLocation:w}),P<=k?s=d:v=d,d=Math.floor((v-s)/2+s);v=d,C=Math.max(1,b-d+1),y=T?m:Math.min(b+d,m)+l,i=Array(y+2),i[y+1]=(1<<h)-1;for(c=y;c>=C;c-=1)if(t=c-1,F=S[z.charAt(t)],p&&(B[t]=+!!F),i[c]=(i[c+1]<<1|1)&F,h&&(i[c]|=(n[c+1]|n[c])<<1|1|n[c+1]),i[c]&Q)if(q=u(e,{errors:h,currentLocation:t,expectedLocation:b,distance:r,ignoreLocation:w}),q<=k){if(k=q,f=t,f<=b)break;C=Math.max(1,2*b-f)}if(U=u(e,{errors:h+1,currentLocation:b,expectedLocation:b,distance:r,ignoreLocation:w}),U>k)break;n=i}return x={isMatch:f>=0,score:Math.max(.001,q)},p&&(M=ar(B,E),M.length?I&&(x.indices=M):x.isMatch=!1),x}function ap(c){for(var b={},a=0,d=c.length,e;a<d;a+=1)e=c.charAt(a),b[e]=(b[e]||0)|1<<d-a-1;return b}G=function(){function d(q){var A=this,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k=c.location,z=k===void 0?a.location:k,i=c.threshold,y=i===void 0?a.threshold:i,l=c.distance,x=l===void 0?a.distance:l,n=c.includeMatches,v=n===void 0?a.includeMatches:n,p=c.findAllMatches,C=p===void 0?a.findAllMatches:p,r=c.minMatchCharLength,u=r===void 0?a.minMatchCharLength:r,h=c.isCaseSensitive,s=h===void 0?a.isCaseSensitive:h,o=c.ignoreLocation,w=o===void 0?a.ignoreLocation:o,g,f,e,m,B,t;if(b(this,d),this.options={location:z,threshold:y,distance:x,includeMatches:v,findAllMatches:C,minMatchCharLength:u,isCaseSensitive:s,ignoreLocation:w},this.pattern=s?q:q.toLowerCase(),this.chunks=[],!this.pattern.length)return;if(g=function(a,b){A.chunks.push({pattern:a,alphabet:ap(a),startIndex:b})},f=this.pattern.length,f>j){for(e=0,m=f%j,B=f-m;e<B;)g(this.pattern.substr(e,j),e),e+=j;m&&(t=f-j,g(this.pattern.substr(t),t))}else g(this.pattern,0)}return c(d,[{key:"searchIn",value:function(b){var f=this.options,q=f.isCaseSensitive,d=f.includeMatches,g,a,p,k,o,l,m,n,e,i,c,j;return q||(b=b.toLowerCase()),this.pattern===b?(g={isMatch:!0,score:0},d&&(g.indices=[[0,b.length-1]]),g):(a=this.options,p=a.location,k=a.distance,o=a.threshold,l=a.findAllMatches,m=a.minMatchCharLength,n=a.ignoreLocation,e=[],i=0,c=!1,this.chunks.forEach(function(a){var t=a.pattern,q=a.alphabet,r=a.startIndex,f=aq(b,t,q,{location:p+r,distance:k,threshold:o,findAllMatches:l,minMatchCharLength:m,includeMatches:d,ignoreLocation:n}),j=f.isMatch,s=f.score,g=f.indices;j&&(c=!0),i+=s,j&&g&&(e=[].concat(h(e),h(g)))}),j={isMatch:c,score:c?i/this.chunks.length:1},c&&d&&(j.indices=e),j)}}]),d}(),f=function(){function a(c){b(this,a),this.pattern=c}return c(a,[{key:"search",value:function(){}}],[{key:"isMultiMatch",value:function(a){return ah(a,this.multiRegex)}},{key:"isSingleMatch",value:function(a){return ah(a,this.singleRegex)}}]),a}();function ah(b,c){var a=b.match(c);return a?a[1]:null}ai=function(d){i(a,d);var e=k(a);function a(c){return b(this,a),e.call(this,c)}return c(a,[{key:"search",value:function(b){var a=b===this.pattern;return{isMatch:a,score:a?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return'exact'}},{key:"multiRegex",get:function(){return/^="(.*)"$/}},{key:"singleRegex",get:function(){return/^=(.*)$/}}]),a}(f),aj=function(d){i(a,d);var e=k(a);function a(c){return b(this,a),e.call(this,c)}return c(a,[{key:"search",value:function(a){var c=a.indexOf(this.pattern),b=c===-1;return{isMatch:b,score:b?0:1,indices:[0,a.length-1]}}}],[{key:"type",get:function(){return'inverse-exact'}},{key:"multiRegex",get:function(){return/^!"(.*)"$/}},{key:"singleRegex",get:function(){return/^!(.*)$/}}]),a}(f),ak=function(d){i(a,d);var e=k(a);function a(c){return b(this,a),e.call(this,c)}return c(a,[{key:"search",value:function(b){var a=b.startsWith(this.pattern);return{isMatch:a,score:a?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return'prefix-exact'}},{key:"multiRegex",get:function(){return/^\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^\^(.*)$/}}]),a}(f),al=function(d){i(a,d);var e=k(a);function a(c){return b(this,a),e.call(this,c)}return c(a,[{key:"search",value:function(a){var b=!a.startsWith(this.pattern);return{isMatch:b,score:b?0:1,indices:[0,a.length-1]}}}],[{key:"type",get:function(){return'inverse-prefix-exact'}},{key:"multiRegex",get:function(){return/^!\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^!\^(.*)$/}}]),a}(f),am=function(d){i(a,d);var e=k(a);function a(c){return b(this,a),e.call(this,c)}return c(a,[{key:"search",value:function(a){var b=a.endsWith(this.pattern);return{isMatch:b,score:b?0:1,indices:[a.length-this.pattern.length,a.length-1]}}}],[{key:"type",get:function(){return'suffix-exact'}},{key:"multiRegex",get:function(){return/^"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^(.*)\$$/}}]),a}(f),Z=function(d){i(a,d);var e=k(a);function a(c){return b(this,a),e.call(this,c)}return c(a,[{key:"search",value:function(a){var b=!a.endsWith(this.pattern);return{isMatch:b,score:b?0:1,indices:[0,a.length-1]}}}],[{key:"type",get:function(){return'inverse-suffix-exact'}},{key:"multiRegex",get:function(){return/^!"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^!(.*)\$$/}}]),a}(f),F=function(e){i(d,e);var f=k(d);function d(o){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=c.location,v=h===void 0?a.location:h,j=c.threshold,t=j===void 0?a.threshold:j,l=c.distance,r=l===void 0?a.distance:l,n=c.includeMatches,p=n===void 0?a.includeMatches:n,g=c.findAllMatches,q=g===void 0?a.findAllMatches:g,m=c.minMatchCharLength,s=m===void 0?a.minMatchCharLength:m,k=c.isCaseSensitive,u=k===void 0?a.isCaseSensitive:k,i=c.ignoreLocation,w=i===void 0?a.ignoreLocation:i,e;return b(this,d),e=f.call(this,o),e._bitapSearch=new G(o,{location:v,threshold:t,distance:r,includeMatches:p,findAllMatches:q,minMatchCharLength:s,isCaseSensitive:u,ignoreLocation:w}),e}return c(d,[{key:"search",value:function(a){return this._bitapSearch.searchIn(a)}}],[{key:"type",get:function(){return'fuzzy'}},{key:"multiRegex",get:function(){return/^"(.*)"$/}},{key:"singleRegex",get:function(){return/^(.*)$/}}]),d}(f),B=function(d){i(a,d);var e=k(a);function a(c){return b(this,a),e.call(this,c)}return c(a,[{key:"search",value:function(e){for(var a=0,c=[],f=this.pattern.length,b,d;(b=e.indexOf(this.pattern,a))>-1;)a=b+f,c.push([b,a-1]);return d=!!c.length,{isMatch:d,score:d?0:1,indices:c}}}],[{key:"type",get:function(){return'include'}},{key:"multiRegex",get:function(){return/^'"(.*)"$/}},{key:"singleRegex",get:function(){return/^'(.*)$/}}]),a}(f),o=[ai,B,ak,al,Z,am,aj,F],y=o.length,$=/ +(?=([^\"]*\"[^\"]*\")*[^\"]*$)/,H='|';function av(b){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return b.split(H).map(function(l){for(var h=l.trim().split($).filter(function(a){return a&&!!a.trim()}),d=[],e=0,m=h.length,g,c,b,i,j,f,k;e<m;e+=1){for(g=h[e],c=!1,b=-1;!c&&++b<y;)i=o[b],j=i.isMultiMatch(g),j&&(d.push(new i(j,a)),c=!0);if(c)continue;for(b=-1;++b<y;)if(f=o[b],k=f.isSingleMatch(g),k){d.push(new f(k,a));break}}return d})}R=new Set([F.type,B.type]),M=function(){function d(m){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=c.isCaseSensitive,g=f===void 0?a.isCaseSensitive:f,h=c.includeMatches,t=h===void 0?a.includeMatches:h,j=c.minMatchCharLength,r=j===void 0?a.minMatchCharLength:j,l=c.ignoreLocation,o=l===void 0?a.ignoreLocation:l,n=c.findAllMatches,p=n===void 0?a.findAllMatches:n,e=c.location,q=e===void 0?a.location:e,k=c.threshold,s=k===void 0?a.threshold:k,i=c.distance,u=i===void 0?a.distance:i;b(this,d),this.query=null,this.options={isCaseSensitive:g,includeMatches:t,minMatchCharLength:r,findAllMatches:p,ignoreLocation:o,location:q,threshold:s,distance:u},this.pattern=g?m:m.toLowerCase(),this.query=av(this.pattern,this.options)}return c(d,[{key:"searchIn",value:function(c){var d=this.query,n,k,s,b,a,g,f,p,m,e,q,o,i,r,j,t,u,l;if(!d)return{isMatch:!1,score:1};n=this.options,k=n.includeMatches,s=n.isCaseSensitive,c=s?c:c.toLowerCase(),b=0,a=[],g=0;for(f=0,p=d.length;f<p;f+=1){m=d[f],a.length=0,b=0;for(e=0,q=m.length;e<q;e+=1)if(o=m[e],i=o.search(c),r=i.isMatch,j=i.indices,t=i.score,r)b+=1,g+=t,k&&(u=o.constructor.type,R.has(u)?a=[].concat(h(a),h(j)):a.push(j));else{g=0,b=0,a.length=0;break}if(b)return l={isMatch:!0,score:g/b},k&&(l.indices=a),l}return{isMatch:!1,score:1}}}],[{key:"condition",value:function(c,a){return a.useExtendedSearch}}]),d}(),n=[];function az(){n.push.apply(n,arguments)}function x(a,b){for(var c=0,e=n.length,d;c<e;c+=1)if(d=n[c],d.condition(a,b))return new d(a,b);return new G(a,b)}m={AND:'$and',OR:'$or'},t={PATH:'$path',PATTERN:'$val'},r=function(a){return!!(a[m.AND]||a[m.OR])},ab=function(a){return!!a[t.PATH]},ac=function(a){return!g(a)&&U(a)&&!r(a)},z=function(a){return D({},m.AND,Object.keys(a).map(function(b){return D({},b,a[b])}))};function ad(a,c){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},b=d.auto,f=b===void 0||b,h=function j(a){var b=Object.keys(a),d=ab(a),h,i,k,l;if(!d&&b.length>1&&!r(a))return j(z(a));if(ac(a)){if(h=d?a[t.PATH]:b[0],i=d?a[t.PATTERN]:a[h],!e(i))throw new Error(Q(h));return k={keyId:v(h),pattern:i},f&&(k.searcher=x(i,c)),k}return l={children:[],operator:b[0]},b.forEach(function(c){var b=a[c];g(b)&&b.forEach(function(a){l.children.push(j(a))})}),l};return r(a)||(a=z(a)),h(a)}function aI(c,d){var b=d.ignoreFieldNorm,e=b===void 0?a.ignoreFieldNorm:b;c.forEach(function(a){var b=1;a.matches.forEach(function(a){var c=a.key,g=a.norm,d=a.score,f=c?c.weight:null;b*=Math.pow(d===0&&f?Number.EPSILON:d,(f||1)*(e?1:g))}),a.score=b})}function aJ(c,a){var b=c.matches;if(a.matches=[],!d(b))return;b.forEach(function(b){var e,f,c;if(!d(b.indices)||!b.indices.length)return;e=b.indices,f=b.value,c={indices:e,value:f},b.key&&(c.key=b.key.src),b.idx>-1&&(c.refIndex=b.idx),a.matches.push(c)})}function aK(a,b){b.score=a.score}function aL(f,i){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},d=c.includeMatches,g=d===void 0?a.includeMatches:d,e=c.includeScore,h=e===void 0?a.includeScore:e,b=[];return g&&b.push(aJ),h&&b.push(aK),f.map(function(a){var c=a.idx,d={item:i[c],refIndex:c};return b.length&&b.forEach(function(b){b(a,d)}),d})}return l=function(){function f(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0;if(b(this,f),this.options=ae({},a,{},d),this.options.useExtendedSearch&&!!0)throw new Error(an);this._keyStore=new N(this.options.keys),this.setCollection(c,e)}return c(f,[{key:"setCollection",value:function(b,a){if(this._docs=b,a&&!(a instanceof s))throw new Error(Y);this._myIndex=a||_(this.options.keys,this._docs,{getFn:this.options.getFn})}},{key:"add",value:function(a){if(!d(a))return;this._docs.push(a),this._myIndex.add(a)}},{key:"remove",value:function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){return!1},b=[],a=0,c=this._docs.length,d;a<c;a+=1)d=this._docs[a],e(d,a)&&(this.removeAt(a),a-=1,c-=1,b.push(d));return b}},{key:"removeAt",value:function(a){this._docs.splice(a,1),this._myIndex.removeAt(a)}},{key:"getIndex",value:function(){return this._myIndex}},{key:"search",value:function(c){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=h.limit,d=f===void 0?-1:f,a=this.options,g=a.includeMatches,i=a.includeScore,j=a.shouldSort,k=a.sortFn,l=a.ignoreFieldNorm,b=e(c)?e(this._docs[0])?this._searchStringList(c):this._searchObjectList(c):this._searchLogical(c);return aI(b,{ignoreFieldNorm:l}),j&&b.sort(k),W(d)&&d>-1&&(b=b.slice(0,d)),aL(b,this._docs,{includeMatches:g,includeScore:i})}},{key:"_searchStringList",value:function(b){var c=x(b,this.options),e=this._myIndex.records,a=[];return e.forEach(function(e){var b=e.v,g=e.i,h=e.n,f,i,j,k;if(!d(b))return;f=c.searchIn(b),i=f.isMatch,j=f.score,k=f.indices,i&&a.push({item:b,idx:g,matches:[{score:j,value:b,norm:h,indices:k}]})}),a}},{key:"_searchLogical",value:function(i){var b=this,e=ad(i,this.options),f=function t(a,d,l){var j,q,c,g,i,p,o,k,e,f,r,s,n;if(!a.children)return j=a.keyId,q=a.searcher,c=b._findMatches({key:b._keyStore.get(j),value:b._myIndex.getValueForItemAtKeyId(d,j),searcher:q}),c&&c.length?[{idx:l,item:d,matches:c}]:[];switch(a.operator){case m.AND:{g=[];for(i=0,p=a.children.length;i<p;i+=1)if(o=a.children[i],k=t(o,d,l),k.length)g.push.apply(g,h(k));else return[];return g}case m.OR:{e=[];for(f=0,r=a.children.length;f<r;f+=1)if(s=a.children[f],n=t(s,d,l),n.length){e.push.apply(e,h(n));break}return e}}},g=this._myIndex.records,a={},c=[];return g.forEach(function(i){var g=i.$,b=i.i,j;d(g)&&(j=f(e,g,b),j.length&&(a[b]||(a[b]={idx:b,item:g,matches:[]},c.push(a[b])),j.forEach(function(d){var e=d.matches,c;(c=a[b].matches).push.apply(c,h(e))})))}),c}},{key:"_searchObjectList",value:function(i){var e=this,f=x(i,this.options),b=this._myIndex,g=b.keys,c=b.records,a=[];return c.forEach(function(i){var c=i.$,j=i.i,b;if(!d(c))return;b=[],g.forEach(function(a,d){b.push.apply(b,h(e._findMatches({key:a,value:c[d],searcher:f})))}),b.length&&a.push({idx:j,item:c,matches:b})}),a}},{key:"_findMatches",value:function(b){var i=b.key,a=b.value,h=b.searcher,e,f,j,c,k,l,m;return d(a)?(e=[],g(a)?a.forEach(function(a){var b=a.v,f=a.i,g=a.n,c,j,k,l;if(!d(b))return;c=h.searchIn(b),j=c.isMatch,k=c.score,l=c.indices,j&&e.push({score:k,key:i,value:b,idx:f,norm:g,indices:l})}):(f=a.v,j=a.n,c=h.searchIn(f),k=c.isMatch,l=c.score,m=c.indices,k&&e.push({score:l,key:i,value:f,norm:j,indices:m})),e):[]}}]),f}(),l.version='6.4.6',l.createIndex=_,l.parseIndex=at,l.config=a,l.parseQuery=ad,az(M),l})